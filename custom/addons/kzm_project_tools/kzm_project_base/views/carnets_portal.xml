<?xml version="1.0" encoding="UTF-8" ?>
<odoo>

    <template id="carnets" name="Carnets">
        <t t-call="portal.portal_layout">
            <t t-set="breadcrumbs_searchbar" t-value="True"/>
            <t t-call="portal.portal_searchbar">
                <t t-set="title">Carnets</t>
            </t>
            <t t-if="carnet_ids" t-call="portal.portal_table">
                <thead>
                    <tr class="active">
                        <th>Nom</th>
                        <th class="text-end">Client</th>
                        <th class="text-end">Contrat Cadre</th>
                        <th class="text-end">Date de début</th>
                        <th class="text-end">Date de fin</th>
                        <th class="text-end">État</th>
                    </tr>
                </thead>
                <t t-foreach="carnet_ids" t-as="carnet_id">
                    <tr>
                        <td class="text-end">
                            <a t-attf-href="/carnet/#{carnet_id.id}">
                                <span t-field="carnet_id.name"/>
                            </a>

                        </td>
                        <td class="text-end">
                            <span t-field="carnet_id.partner_id.name"/>
                        </td>
                        <td class="text-end">
                            <span t-field="carnet_id.contract_id.name"/>
                        </td>
                        <td class="text-end">
                            <span t-field="carnet_id.first_date"/>
                        </td>
                        <td class="text-end">

                            <span t-field="carnet_id.last_date"/>
                        </td>


                        <td class="text-end">
                            <t t-set="status"
                               t-value="dict([('new','Nouveau'),('in_progress','En cours'),('expired','Résilié'), (False,False)])"/>
                            <t t-esc="status[carnet_id.state]"/>
                        </td>

                    </tr>
                </t>
            </t>
            <p t-else="">There are currently no carnets for your account.</p>
        </t>
    </template>
        <template id="carnets_followup" name="Carnetscc">
        <t t-call="portal.portal_layout">
            <t t-set="wrapwrap_classes" t-value="'o_portal_bg_dark'"/>


            <div class="row mt16 o_project_portal_sidebar">

                <div id="ticket_content" class="col-12 col-lg justify-content-end">
                    <div id="card" class="card">
                        <div id="card_header" class="card-header container" data-anchor="true">
                            <div class="row g-0">
                                <div class="col-md">
                                    <h5 class="row mx-1 mb-1 mb-md-0">
                                        <div class="col-9 text-truncate">
                                            <span t-field="carnet.name"/>
                                            <small class="text-muted "> (#<span t-field="carnet.id"/>)</small>
                                        </div>
                                        <div class="col-3 text-end">
                                            <small class="text-end">Stage:</small>
                                            <span t-field="carnet.state" class=" badge rounded-pill text-bg-info" />
                                        </div>
                                    </h5>
                                </div>
                            </div>
                        </div>
                        <div id="card_body" class="card-body">
                            <div class="row mb-4">
                                <strong class="col-lg-2">Client</strong>
                                <span class="col-lg-10" t-field="carnet.partner_id.name"/>
                            </div>
                               <div class="row mb-4">
                                <strong class="col-lg-2">Date de début</strong>
                                <span class="col-lg-10" t-field="carnet.first_date" t-options='{"widget": "date", "hide_seconds": True}'/>
                            </div>
                               <div class="row mb-4">
                                <strong class="col-lg-2">Date de fin</strong>
                                <span class="col-lg-10" t-field="carnet.last_date" t-options='{"widget": "date", "hide_seconds": True}'/>
                            </div>
                            <div class="row mb-4">
                                <strong class="col-lg-2">Capacité</strong>
                                <span class="col-lg-10" t-field="carnet.capacity"/>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

       <template id="portal_my_home_menu_carnet" inherit_id="portal.portal_breadcrumbs">
           <xpath expr="//ol[hasclass('o_portal_submenu')]" position="inside">
                  <t t-if="page_name == 'carnets'">
                <li class="breadcrumb-item"><a href="/carnets">Carnets</a></li>

            </t>
           </xpath>

    </template>
</odoo>