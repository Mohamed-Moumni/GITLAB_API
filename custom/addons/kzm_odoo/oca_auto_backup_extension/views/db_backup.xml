<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_db_backup_extension_gcloud" model="ir.ui.view">
        <field name="name">auto.backup.google.storage</field>
        <field name="model">db.backup</field>
        <field name="inherit_id" ref="auto_backup.view_backup_conf_form"/>
        <field name="arch" type="xml">
            <form position="replace">
                <form>
                    <header>
                        <button name="action_backup" type="object" string="Execute backup" class="oe_highlight"/>
                        <button
                            name="action_gcloud_test_connection"
                            type="object"
                            attrs="{'invisible': [('method', '!=', 'gcloud')]}"
                            string="Test GCloud Connection"
                            icon="fa-television"/>
                        <button name="action_sftp_test_connection" attrs="{'invisible': [('method', '!=', 'sftp')]}"
                                type="object" string="Test SFTP Connection"
                                icon="fa-television"/>
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <h1>
                                <field name="name"/>
                            </h1>
                        </div>
                        <group string="Basic backup configuration">
                            <field name="folder"/>
                            <field name="days_to_keep"/>
                            <field name="method"/>
                            <field name="backup_format"/>
                        </group>
                        <div attrs="{'invisible': [('method', '!=', 'sftp')]}">
                            <div class="bg-warning">
                                <h3>Warning:</h3>
                                Use SFTP with caution! This writes files to external servers under the path you specify.
                            </div>
                            <group string="SFTP Settings">
                                <field name="sftp_host" placeholder="sftp.example.com"/>
                                <field name="sftp_port"/>
                                <field name="sftp_user" placeholder="john"/>
                                <field name="sftp_password"/>
                                <field name="sftp_private_key" placeholder="/home/odoo/.ssh/id_rsa"/>
                            </group>
                        </div>
                        <div attrs="{'invisible': [('method', '!=', 'gcloud')]}">
                            <group string="Google cloud Settings">
                                <field name="GOOGLE_APPLICATION_CREDENTIALS"
                                       placeholder="/opt/gcloud/GCLOUD-STORAGE/KARIZMA-CLOUD-ca1aa0dd8fd1.json"
                                       attrs="{'required':[('method', '=', 'gcloud')]}"/>
                                <field name="bucket_name" placeholder="kzm"
                                       attrs="{'required':[('method', '=', 'gcloud')]}"/>
                            </group>
                        </div>
                        <separator string="Help" colspan="2"/>
                        <div>
                            Automatic backups of the database can be scheduled as follows:
                            <ol>
                                <li>Go to Settings / Technical / Automation / Scheduled Actions.</li>
                                <li>Search the action named 'Backup scheduler'.</li>
                                <li>Set the scheduler to active and fill in how often you want backups generated.</li>
                            </ol>
                        </div>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids"/>
                        <field name="activity_ids"/>
                        <field name="message_ids"/>
                    </div>
                </form>
            </form>
        </field>
    </record>
</odoo>
